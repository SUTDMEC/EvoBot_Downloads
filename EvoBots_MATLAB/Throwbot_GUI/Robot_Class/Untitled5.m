clear
clc
path=[     1     1     1
     2     2     2
     3     3     3
     4     4     4
     5     5     5
     6     6     6
     7     7     7
     8     8     8
     9     9     9
    10    10    10
    11    10    11
    12    10    12
    13    10    13
    14    10    14
    15    10    15
    16    10    16
    17    10    17
    18    10    18
    19    10    19
    20    10    20
    21    10    21
    22    10    22
    23    10    23
    24    10    24
    25    10    25
    26    10    26
    27    10    27
    28    10    28
    29    10    29
    30    10    30
    31    10    31
    32    10    32
    33    10    33
    34    10    34
    35    10    35
    36    10    36
    37    10    37
    38    10    38
    39    10    39
    40    10    40
    41    10    41
    42    10    42
    43    10    43
    44    10    44
    45    10    45
    46    10    46
    47    10    47
    48    10    48
    49    10    49
    49     9    49
    49    11    49
    51     8    49
    52    12    49
    53     7    49
    54    13    49
    55     6    49
    56    14    49
    48     9    48
    48    11    48
    57     5    49
    58    15    49
    51     8    48
    52    12    48
    53     7    48
    54    13    48
    61     4    49
    62    16    49
    55     6    48
    56    14    48
    47     9    47
    47    11    47
    57     5    48
    58    15    48
    67     3    49
    68    17    49
    59     8    47
    60    12    47
    63     7    47
    64    13    47
    61     4    48
    62    16    48
    65     6    47
    66    14    47
    75     2    49
    76    18    49
    46     9    46
    46    11    46
    67     3    48
    68    17    48
    69     5    47
    70    15    47
    71     8    46
    72    12    46
    73     4    47
    74    16    47
    85     1    49
    86    19    49
    77     7    46
    78    13    46
    75     2    48
    76    18    48
    79     6    46
    80    14    46
    45     9    45
    45    11    45
    81     3    47
    82    17    47
    83     5    46
    84    15    46
    98    20    49
    85     1    48
    86    19    48
    87     8    45
    88    12    45
    91     4    46
    92    16    46
    89     2    47
    90    18    47
    93     7    45
    94    13    45
    44     9    44
    44    11    44
    99     6    45
   100    14    45
    98    20    48
    95     3    46
    96    17    46
   111    21    49
   101     1    47
   102    19    47
   103     5    45
   104    15    45
   105     8    44
   106    12    44
   107     2    46
   108    18    46
   109     4    45
   110    16    45
   111    21    48
   114     7    44
   115    13    44
    43     9    43
    43    11    43
   113    20    47
   129    22    49
   120     6    44
   121    14    44
   116     3    45
   117    17    45
   118     1    46
   119    19    46
   124     5    44
   125    15    44
   129    22    48
   127     2    45
   128    18    45
   126    21    47
   122     8    43
   123    12    43
   132     4    44
   133    16    44
    42     9    42
    42    11    42
   146    23    49
   131    20    46
   134     7    43
   135    13    43
   138     3    44
   136     1    45
   139    17    44
   137    19    45
   141     6    43
   142    14    43
   140    22    47
   146    23    48
   147     5    43
   148    15    43
   145    21    46
   149     2    44
   150    18    44
    41     9    41
    41    11    41
   165    24    49
   143     8    42
   152    20    45
   144    12    42
   153     4    43
   154    16    43
   159     7    42
   160    13    42
   156     1    44
   157    19    44
   155    23    47
   161     3    43
   162    17    43
   158    22    46
   165    24    48
   167     6    42
   168    14    42
   166    21    45
   173     5    42
   174    15    42
    40     9    40
    40    11    40
   184    25    49
   169     2    43
   171    18    43
   172    20    44
   163     8    41
   177     4    42
   164    12    41
   178    16    42
   175    23    46
   176    24    47
   179    22    45
   180     1    43
   181    19    43
   184    25    48
   185     7    41
   187    13    41
   188     3    42
   189    17    42
   186    21    44
   190     6    41
   191    14    41
    39     9    39
    39    11    39
   206    26    49
   199     5    41
   200    15    41
   195     2    42
   193    20    43
   196    18    42
   194    24    46
   197    23    45
   198    25    47
   182     8    40
   183    12    40
   202     4    41
   203    16    41
   201    22    44
   206    26    48
   207     1    42
   208    19    42
   210     7    40
   209    21    43
   212    13    40
   211     3    41
   213    17    41
    38     9    38
    38    11    38
   229    27    49
   220     6    40
   221    14    40
   214    24    45
   215    25    46
   218    20    42
   216    23    44
   219    26    47
   222     2    41
   223    18    41
   225     5    40
   226    15    40
   224    22    43
   229    27    48
   204     8    39
   205    12    39
   230     4    40
   231    16    40
   232     1    41
   234    19    41
    37     9    37
    37    11    37
   233    21    42
   235    25    45
   240     3    40
   238     7    39
   241    17    40
   239    13    39
   236    24    44
   253    28    49
   237    26    46
   242    23    43
   243    27    47
   246     6    39
   248    14    39
   245    20    41
   249     2    40
   250    18    40
   247    22    42
   254     5    39
   255    15    39
   253    28    48
   227     8    38
   228    12    38
    36     9    36
    36    11    36
   263     4    39
   264    16    39
   256    25    44
   257    26    45
   258    21    41
   261     1    40
   262    19    40
   259    24    43
   260    27    46
   282    29    49
   269     3    39
   270    17    39
   265    23    42
   266    28    47
   267     7    38
   268    13    38
   272    20    40
   278     6    38
   280    14    38
   275    22    41
   277     2    39
   279    18    39
   282    29    48
    35     9    35
    35    11    35
   276    26    44
   286     5    38
   287    15    38
   281    25    43
   283    27    45
   251     8    37
   252    12    37
   284    24    42
   285    28    46
   288    21    40
   292     4    38
   293    16    38
   289     1    39
   290    19    39
   308    30    49
   291    23    41
   294    29    47
   299     3    38
   300    17    38
   295     7    37
   296    13    37
   305    20    39
   303    22    40
   301    26    43
    34     9    34
    34    11    34
   302    27    44
   308    30    48
   313     6    37
   314    14    37
   306    25    42
   309     2    38
   307    28    45
   310    18    38
   338    31    50
   358    30    51
   359    29    52
   360    28    53
   361    27    54
   362    26    55
   363    25    56
   364    24    57
   365    23    58
   366    22    59
   367    21    60
   368    20    60
   369    19    60
   370    18    60
   371    17    60
   372    16    60
   373    15    60
   374    14    60
   375    13    60
   376    12    60
   377    11    60
   378    10    60];

start=[1,1];
goal=[10,60];
load trialmap;
map=trialmap;
pt=goal;
mod_path=[path(:,2) path(:,3)];
path=mod_path;
path=unique(path,'rows');
new_neigh=[];
pt_log=[];
while pt(1)~=start(1)&&pt(2)~=start(2)
    %Find neighbours which are part of the path
    neigh=neighbours(map,pt);
    %filter neighbours so that only the ones that are part of the path are
    %returned
    s_n=size(neigh);
    s_path=size(path);
    new_neigh=[];
    for i=1:s_n(1)
        cnt=0;
        for j=1:s_path(1)
            if isequal([neigh(i,1) neigh(i,2)],[path(j,1) path(j,2)])
                cnt=cnt+1;
            end
        end
        if cnt>0
            new_neigh=[new_neigh;neigh(i,:)];
        end
    end
    
    %Remove pt from the path
    for i=1:s_path
        if isequal(pt,[path(i,1) path(i,2)])
            path(i,:)=[];
            break
        end
    end
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %Find which new neighbour is closest to the starting point
    s_nn=size(new_neigh);
    for i=1:s_nn(1)
        d(i)=norm([new_neigh(i,1) new_neigh(i,2)]-[start(1) start(2)]);
    end
    f=find(min(d)==d);
    pt=new_neigh(f(1),:);
    pt_log=[pt_log;pt];
end